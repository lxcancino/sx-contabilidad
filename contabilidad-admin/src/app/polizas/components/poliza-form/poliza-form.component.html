<form [formGroup]="form">
  <mat-card>
    <mat-card-title>
      PÃ³liza {{ poliza?.concepto }} {{ poliza?.folio }}
    </mat-card-title>
    <mat-card-subtitle>
      <span layout>
        <span class="pad-left pad-right"
          >Tipo: {{ poliza.tipo }} {{ poliza.subtipo }} Fecha:</span
        >
        <span class="pad-left"
          >Fecha: {{ poliza.fecha | date: 'dd/MM/yyyy' }}</span
        >
        <span class="pad-left" *ngIf="poliza.cierre"
          >Cierre: {{ poliza.cierre | date: 'dd/MM/yyyy' }}</span
        >
        <span flex></span> <span>Usuario: {{ poliza.updateUser }}</span>
      </span>
    </mat-card-subtitle>
    <mat-divider></mat-divider>

    <div class="partidas-panel" style="width: 100%; height: 650px;">
      <sx-poliza-partidas-table
        #partidasGrid
        [partidas]="poliza.partidas"
        (totalesChanged)="onTotales($event)"
      ></sx-poliza-partidas-table>
    </div>

    <mat-divider></mat-divider>
    <mat-card-actions>
      <div layout>
        <button mat-button type="button" (click)="cancel.emit(poliza)">
          Cancelar
        </button>
        <button
          mat-button
          [disabled]="form.invalid || form.pristine"
          *ngIf="!form.disabled"
          (click)="onSubmit()"
        >
          <mat-icon>save</mat-icon> Salvar
        </button>
        <button
          mat-button
          color="primary"
          (click)="recalcular.emit(poliza)"
          type="button"
        >
          <mat-icon>loop</mat-icon> Recalcular
        </button>
        <button mat-button (click)="print.emit(poliza)" type="button">
          <mat-icon>print</mat-icon> Imprimir
        </button>
        <button mat-button (click)="cerrar.emit(poliza)" color="primary">
          <mat-icon>layers_clear</mat-icon> Cerrar
        </button>
        <button mat-button (click)="delete.emit(poliza)" color="warn">
          <mat-icon>delete</mat-icon> Eliminar
        </button>
        <span
          *ngIf="(totales$ | async) as t"
          class="text-md"
          layout
          layout-align="center center"
        >
          <span flex> </span> <span> Debe: {{ t.debe | currency }} </span>
          <span class="pad-left"> Haber: {{ t.haber | currency }} </span>
          <span class="pad-left"> Cuadre: {{ t.cuadre | currency }} </span>
        </span>
      </div>
    </mat-card-actions>
  </mat-card>
</form>
